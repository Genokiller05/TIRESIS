<div class="flex min-h-screen bg-gray-100 dark:bg-gray-900 font-display">
  <!-- Main Content -->
  <main class="flex-1 p-8">
    <div class="mx-auto max-w-4xl">
      <!-- PageHeading -->
      <header class="mb-8">
        <p class="text-gray-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">{{ uiText.pageTitle }}</p>
      </header>
      <!-- ProfileHeader -->
      <section class="mb-8 rounded-xl bg-white dark:bg-gray-800 p-6 @container relative">
        <button (click)="navigateTo($event, '/home')" class="absolute top-4 right-4 p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
          <span class="material-symbols-outlined">arrow_forward</span>
        </button>
        <div class="flex w-full flex-col gap-6 @[520px]:flex-row @[520px]:justify-between @[520px]:items-center">
          <div class="flex items-center gap-6">
            <div class="relative">
              <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-24 w-24" [style.backgroundImage]="'url(' + profileImageUrl + ')'"></div>
              <div *ngIf="isEditingProfile" class="absolute inset-0 flex items-center justify-center bg-black/50 rounded-full cursor-pointer">
                <label for="profile-image-upload" class="text-white text-sm cursor-pointer">Cambiar</label>
                <input id="profile-image-upload" type="file" class="hidden" accept="image/*" (change)="onFileSelected($event)">
              </div>
            </div>
            <div class="flex flex-col justify-center">
              <!-- View Mode -->
              <p *ngIf="!isEditingProfile" class="text-gray-900 dark:text-white text-[22px] font-bold leading-tight tracking-[-0.015em]">{{ adminName }}</p>
              <!-- Edit Mode -->
              <input *ngIf="isEditingProfile" type="text" [(ngModel)]="adminName" class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-white rounded-lg p-2 text-lg font-bold">
              
              <p class="text-gray-500 dark:text-gray-400 text-base font-normal leading-normal">Administrador</p>
              <p class="text-gray-500 dark:text-gray-400 text-base font-normal leading-normal">Estado: Activo</p>
            </div>
          </div>
          <button (click)="toggleEditProfile()" class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-purple-600 text-white text-sm font-bold leading-normal tracking-[0.015em] w-full max-w-[480px] @[480px]:w-auto hover:bg-purple-700 transition-colors">
            <span class="truncate">{{ isEditingProfile ? uiText.saveChanges : uiText.editProfile }}</span>
          </button>
        </div>
      </section>
      <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
        <div class="lg:col-span-2">
          <!-- Personal Information Card -->
          <div class="rounded-xl bg-white dark:bg-gray-800">
            <header class="border-b border-gray-200 dark:border-gray-700 p-6">
              <h2 class="text-gray-900 dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">{{ uiText.personalInfoTitle }}</h2>
              <p class="text-gray-500 dark:text-gray-400 text-sm mt-1">{{ uiText.personalInfoSubtitle }}</p>
            </header>
            <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6">
              <div class="flex flex-col gap-1">
                <p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">{{ uiText.emailLabel }}</p>
                <p class="text-gray-900 dark:text-white text-sm font-normal leading-normal">{{ adminEmail }}</p>
              </div>
              <div class="flex flex-col gap-1">
                <p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">{{ uiText.phoneLabel }}</p>
                <!-- View Mode -->
                <p *ngIf="!isEditingProfile" class="text-gray-900 dark:text-white text-sm font-normal leading-normal">{{ adminPhone }}</p>
                <!-- Edit Mode -->
                <input *ngIf="isEditingProfile" type="text" [(ngModel)]="adminPhone" class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-white rounded-lg p-2 text-sm">
              </div>
              <div class="flex flex-col gap-1">
                <p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">{{ uiText.lastLoginLabel }}</p>
                <p class="text-gray-900 dark:text-white text-sm font-normal leading-normal">{{ lastLoginDate | date:'dd/MM/yyyy HH:mm' }}</p>
              </div>
            </div>
          </div>
          <!-- Security Settings Card -->
          <div class="mt-8 rounded-xl bg-white dark:bg-gray-800">
            <header class="border-b border-gray-200 dark:border-gray-700 p-6">
              <h2 class="text-gray-900 dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">{{ uiText.securityTitle }}</h2>
              <p class="text-gray-500 dark:text-gray-400 text-sm mt-1">{{ uiText.securitySubtitle }}</p>
            </header>
            <div class="p-6 space-y-6">
              <!-- View Mode -->
              <div *ngIf="!isChangingPassword" class="flex items-center justify-between">
                <div>
                  <p class="text-gray-900 dark:text-white text-sm font-medium">{{ uiText.passwordLabel }}</p>
                  <p class="text-gray-500 dark:text-gray-400 text-sm">{{ uiText.lastChangedLabel }}</p>
                </div>
                <button (click)="showChangePassword()" class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-9 px-3 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-white text-sm font-medium leading-normal tracking-[0.015em] hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                  <span class="truncate">{{ uiText.changePasswordBtn }}</span>
                </button>
              </div>
              <!-- Change Password Form -->
              <div *ngIf="isChangingPassword" class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1">{{ uiText.newPasswordLabel }}</label>
                  <input type="password" [(ngModel)]="newPassword" class="w-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-white rounded-lg p-2 text-sm" placeholder="Introduce la nueva contrase単a">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1">{{ uiText.confirmPasswordLabel }}</label>
                  <input type="password" [(ngModel)]="confirmPassword" class="w-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-white rounded-lg p-2 text-sm" placeholder="Confirma la nueva contrase単a">
                </div>
                <p *ngIf="passwordErrorMessage" class="text-red-500 text-sm">{{ passwordErrorMessage }}</p>
                <div class="flex justify-end space-x-4 pt-2">
                  <button (click)="cancelChangePassword()" class="px-4 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">{{ uiText.cancelBtn }}</button>
                  <button (click)="confirmChangePassword()" class="px-4 py-2 text-sm text-white bg-purple-600 rounded-lg hover:bg-purple-700">{{ uiText.acceptBtn }}</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Application Preferences Card -->
        <div class="rounded-xl bg-white dark:bg-gray-800">
          <header class="border-b border-gray-200 dark:border-gray-700 p-6">
            <h2 class="text-gray-900 dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">{{ uiText.prefsTitle }}</h2>
            <p class="text-gray-500 dark:text-gray-400 text-sm mt-1">{{ uiText.prefsSubtitle }}</p>
          </header>
          <div class="p-6 space-y-6">
            <div>
              <label class="block text-sm font-medium text-gray-500 dark:text-gray-400" for="language">{{ uiText.languageLabel }}</label>
              <select [ngModel]="selectedLanguage" (change)="setLanguage($event)" class="mt-1 block w-full rounded-lg border-gray-300 bg-white dark:border-gray-600 dark:bg-gray-700 dark:text-white py-2 pl-3 pr-10 text-base focus:border-purple-500 focus:outline-none focus:ring-purple-500 sm:text-sm" id="language" name="language">
                <option>Espa単ol</option>
                <option>English</option>
              </select>
            </div>
            <div class="flex items-center justify-between">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">{{ uiText.themeLabel }}</p>
              <div class="flex items-center rounded-lg bg-gray-100 dark:bg-gray-700 p-1">
                <button (click)="setTheme('light')" [ngClass]="{'bg-white dark:bg-gray-600 text-gray-900 dark:text-white': currentTheme === 'light', 'text-gray-500 dark:text-gray-400': currentTheme !== 'light'}" class="rounded-md px-2 py-1 text-sm">
                  <span class="material-symbols-outlined text-base">light_mode</span>
                </button>
                <button (click)="setTheme('dark')" [ngClass]="{'bg-purple-600 text-white': currentTheme === 'dark', 'text-gray-500 dark:text-gray-400': currentTheme !== 'dark'}" class="rounded-md px-2 py-1 text-sm">
                  <span class="material-symbols-outlined text-base">dark_mode</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Success Modal -->
<div *ngIf="isSuccessModalVisible" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-gray-100 dark:bg-gray-800 p-8 rounded-lg shadow-xl text-center">
    <p class="text-lg font-medium text-gray-900 dark:text-white mb-6">Contrase単a cambiada exitosamente</p>
    <div class="flex justify-center space-x-4">
      <button (click)="hideSuccessModal()" class="px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition">Aceptar</button>
    </div>
  </div>
</div>